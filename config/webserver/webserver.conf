<VirtualHost *:80>
    ServerAdmin admin@example.com
    ServerName mystro.ops.env.inqlabs.com
    ServerAlias mystro.inqlabs.com
    DocumentRoot /srv/apps/mystroserver/current/public

    <Directory "/srv/apps/mystroserver/current/public">
        AllowOverride all
        Options -MultiViews Indexes +ExecCGI FollowSymLinks
        Order allow,deny
        Allow from all
    </Directory>

    RewriteEngine On

    # Redirect all non-static requests to thin
    RewriteCond %{DOCUMENT_ROOT}/%{REQUEST_FILENAME} !-f
    RewriteRule ^/(.*)$ balancer://unicornservers%{REQUEST_URI} [P,QSA,L]

    <Proxy balancer://unicornservers>
        BalancerMember http://127.0.0.1:5000
        BalancerMember http://127.0.0.1:5001
        BalancerMember http://127.0.0.1:5002
    </Proxy>

    <Proxy *>
        Order deny,allow
        Allow from all
    </Proxy>

    # Possible values include: debug, info, notice, warn, error, crit,
    # alert, emerg.
    LogLevel warn
    ErrorLog /srv/apps/mystroserver/current/log/apache-error.log
    CustomLog /srv/apps/mystroserver/current/log/apache-access.log combined
</VirtualHost>
